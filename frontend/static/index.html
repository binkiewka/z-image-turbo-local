<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Z-Image-Turbo</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        surface: {
                            DEFAULT: '#141414',
                            light: '#1a1a1a',
                            dark: '#0a0a0a'
                        },
                        accent: {
                            DEFAULT: '#22c55e',
                            hover: '#16a34a',
                            muted: '#166534',
                            glow: 'rgba(34, 197, 94, 0.2)'
                        }
                    }
                }
            }
        }
    </script>

    <!-- Alpine.js Collapse Plugin -->
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/static/logo.svg">

    <style>
        * {
            font-family: 'Inter', system-ui, sans-serif;
        }

        body {
            background: #0a0a0a;
            min-height: 100vh;
        }

        /* Glass morphism effect */
        .glass {
            background: rgba(20, 20, 20, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .glass-hover:hover {
            border-color: rgba(34, 197, 94, 0.3);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.1);
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #141414;
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #444;
        }

        /* Progress ring animation */
        @keyframes progress-spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .progress-ring {
            animation: progress-spin 2s linear infinite;
        }

        /* Button shimmer effect */
        .btn-shimmer {
            position: relative;
            overflow: hidden;
        }

        .btn-shimmer::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .btn-shimmer:hover::before {
            left: 100%;
        }

        /* Gallery hover effect */
        .gallery-item {
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .gallery-item:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.2);
        }

        /* Toast animation */
        @keyframes toast-in {
            from {
                transform: translateY(100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes toast-out {
            from {
                transform: translateY(0);
                opacity: 1;
            }

            to {
                transform: translateY(100%);
                opacity: 0;
            }
        }

        .toast-enter {
            animation: toast-in 0.3s ease-out;
        }

        .toast-leave {
            animation: toast-out 0.3s ease-in;
        }

        /* Input focus glow */
        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #22c55e !important;
            box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2);
        }

        /* Honeycomb Background */
        .bg-honeycomb {
            background-color: #050505;
            background-image:
                radial-gradient(circle at 50% 0%, rgba(34, 197, 94, 0.15) 0%, transparent 70%),
                url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%2322c55e' fill-opacity='0.03' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            background-attachment: fixed;
        }

        /* Tab transitions */
        .tab-content {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .tab-content.hidden {
            opacity: 0;
            transform: translateY(10px);
            pointer-events: none;
            position: absolute;
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .accordion-content.open {
            max-height: 500px;
        }

        .accordion-chevron {
            transition: transform 0.2s ease;
        }

        .accordion-chevron.open {
            transform: rotate(180deg);
        }

        /* Dark dropdown options */
        select {
            background-color: #141414;
        }

        select option {
            background-color: #141414;
            color: #e5e5e5;
            padding: 8px;
        }

        select option:hover,
        select option:focus,
        select option:checked {
            background-color: #1a1a1a;
        }
    </style>
</head>

<body class="bg-honeycomb text-gray-200" x-data="app()" x-init="init()">
    <div class="min-h-screen p-4 md:p-6 lg:p-8">
        <!-- Header -->
        <header class="max-w-7xl mx-auto mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="flex items-center gap-3 text-2xl md:text-3xl font-bold text-white tracking-tight">
                        <img src="/static/logo.svg"
                            class="w-8 h-8 md:w-10 md:h-10 drop-shadow-[0_0_8px_rgba(34,197,94,0.3)]"
                            alt="Z-Image Logo">
                        <span>
                            <span x-show="activeTab === 'image'">Z-IMAGE<span class="text-accent">TURBO</span></span>
                            <span x-show="activeTab === 'video'">Wan2.2 <span
                                    class="text-accent">Generator</span></span>
                        </span>
                    </h1>
                    <div class="flex items-center gap-2 mt-1">
                        <p class="text-gray-500 text-sm">AI-Powered Image & Video Generation</p>
                        <div
                            class="flex items-center gap-1.5 px-2 py-0.5 rounded-full bg-surface-light border border-gray-800">
                            <div class="w-2 h-2 rounded-full"
                                :class="isConnected ? 'bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.5)]' : 'bg-red-500'">
                            </div>
                            <span class="text-xs font-medium" :class="isConnected ? 'text-green-500' : 'text-red-500'"
                                x-text="isConnected ? 'Online' : 'Offline'"></span>
                        </div>
                    </div>
                </div>

                <!-- Tab Navigation -->
                <div class="flex gap-2">
                    <button @click="activeTab = 'image'"
                        :class="activeTab === 'image' ? 'bg-accent text-black' : 'bg-surface-light text-gray-400 hover:text-white'"
                        class="px-4 py-2 rounded-lg font-medium transition-all duration-200">
                        Image
                    </button>
                    <button @click="activeTab = 'video'"
                        :class="activeTab === 'video' ? 'bg-accent text-black' : 'bg-surface-light text-gray-400 hover:text-white'"
                        class="px-4 py-2 rounded-lg font-medium transition-all duration-200">
                        Video
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto">
            <!-- Image Generation Tab -->
            <div x-show="activeTab === 'image'" x-transition:enter="transition ease-out duration-300"
                x-transition:enter-start="opacity-0 transform translate-y-4"
                x-transition:enter-end="opacity-100 transform translate-y-0">
                
                <!-- Mode Toggle -->
                <div class="flex justify-center mb-6">
                    <div class="inline-flex rounded-xl bg-surface-light p-1">
                        <button @click="characterMode = false"
                            :class="!characterMode ? 'bg-accent text-black' : 'text-gray-400 hover:text-white'"
                            class="px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200">
                            Standard Mode
                        </button>
                        <button @click="toggleCharacterMode()"
                            :class="characterMode ? 'bg-accent text-black' : 'text-gray-400 hover:text-white'"
                            class="px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200">
                            Character Mode
                        </button>
                    </div>
                </div>

                <!-- Standard Mode Content -->
                <div x-show="!characterMode">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 items-stretch">
                    <!-- Left Panel: Controls -->
                    <div class="glass rounded-2xl p-6 glass-hover h-full flex flex-col">
                        <!-- Prompt Input -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-400 mb-2">Prompt</label>
                            <textarea x-model="imagePrompt" @keydown.ctrl.enter="generateImage()"
                                @keydown.meta.enter="generateImage()"
                                placeholder="Describe the image you want to create..." rows="4"
                                class="w-full bg-black/30 border border-gray-700/50 rounded-xl px-4 py-3 text-white placeholder-gray-500 resize-none transition-all duration-200"></textarea>
                            <p class="text-xs text-gray-500 mt-1">Press Ctrl+Enter to generate</p>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex gap-3 mb-6">
                            <button @click="generateImage()" :disabled="isGenerating"
                                class="flex-1 bg-accent hover:bg-accent-hover disabled:opacity-50 disabled:cursor-not-allowed text-black font-semibold py-3 px-6 rounded-xl transition-all duration-200 btn-shimmer">
                                <span x-show="!isGenerating">Generate</span>
                                <span x-show="isGenerating" class="flex items-center justify-center gap-2">
                                    <svg class="w-5 h-5 animate-spin" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                            stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor"
                                            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                        </path>
                                    </svg>
                                    Generating...
                                </span>
                            </button>
                            <button @click="enhancePrompt()" :disabled="isEnhancing"
                                class="px-6 py-3 bg-surface-light hover:bg-gray-700 disabled:opacity-50 text-gray-300 font-medium rounded-xl transition-colors duration-200">
                                <span x-show="!isEnhancing">Enhance</span>
                                <span x-show="isEnhancing" class="flex items-center gap-2">
                                    <svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                            stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor"
                                            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                        </path>
                                    </svg>
                                    Enhancing...
                                </span>
                            </button>
                        </div>

                        <!-- Settings -->
                        <div class="space-y-4">
                            <div class="grid grid-cols-3 gap-3">
                                <!-- Aspect Ratio -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-400 mb-2">Ratio</label>
                                    <select x-model="imageSettings.aspectRatio"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-xs">
                                        <option value="1:1">1:1</option>
                                        <option value="3:4">3:4</option>
                                        <option value="4:3">4:3</option>
                                        <option value="16:9">16:9</option>
                                        <option value="9:16">9:16</option>
                                    </select>
                                </div>

                                <!-- Seed -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-400 mb-2">Seed</label>
                                    <input type="number" x-model.number="imageSettings.seed" placeholder="-1"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-xs">
                                </div>

                                <!-- Count -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-400 mb-2">Count</label>
                                    <select x-model.number="imageSettings.numImages"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-xs">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Advanced Settings -->
                            <div class="space-y-4 pt-4 border-t border-gray-700/50">
                                <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Advanced</h4>

                                <div class="grid grid-cols-2 gap-4">
                                    <!-- Steps -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-400 mb-2">Steps</label>
                                        <input type="range" x-model.number="imageSettings.steps" min="4" max="15"
                                            step="1"
                                            class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-accent mb-2">
                                        <div class="text-right text-xs text-gray-500"
                                            x-text="imageSettings.steps + ' steps'"></div>
                                    </div>

                                    <!-- CFG Scale -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-400 mb-2">CFG Scale</label>
                                        <input type="range" x-model.number="imageSettings.cfg" min="1.0" max="20.0"
                                            step="0.5"
                                            class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-accent mb-2">
                                        <div class="text-right text-xs text-gray-500" x-text="imageSettings.cfg"></div>
                                    </div>
                                </div>

                                <div class="grid grid-cols-2 gap-4">
                                    <!-- Sampler -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-400 mb-2">Sampler</label>
                                        <select x-model="imageSettings.sampler"
                                            class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-xs">
                                            <template x-for="s in models.samplers" :key="s">
                                                <option :value="s" x-text="s"></option>
                                            </template>
                                        </select>
                                    </div>

                                    <!-- Scheduler -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-400 mb-2">Scheduler</label>
                                        <select x-model="imageSettings.scheduler"
                                            class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-xs">
                                            <template x-for="s in models.schedulers" :key="s">
                                                <option :value="s" x-text="s"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- LoRA & Upscale -->
                            <div class="space-y-4 pt-4 border-t border-gray-700/50">
                                <!-- LoRA -->
                                <div>
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="block text-sm font-medium text-gray-400">LoRAs</label>
                                        <button @click="addLora()"
                                            class="text-xs text-accent hover:text-accent-hover font-medium">
                                            + Add
                                        </button>
                                    </div>

                                    <template x-for="(model, index) in imageSettings.loras" :key="index">
                                        <div class="mb-3 bg-white/5 p-2 rounded-lg border border-gray-700/30">
                                            <div class="flex gap-2 mb-2">
                                                <select x-model="model.name"
                                                    class="flex-1 min-w-0 bg-black/30 border border-gray-700/50 rounded-lg px-3 py-2 text-white text-sm truncate">
                                                    <option value="">Select LoRA...</option>
                                                    <template x-for="l in models.image.loras" :key="l">
                                                        <option :value="l" x-text="l.split('/').pop()"></option>
                                                    </template>
                                                </select>
                                                <button @click="removeLora(index)"
                                                    class="text-gray-500 hover:text-red-400 px-1">
                                                    <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                                        viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                                    </svg>
                                                </button>
                                            </div>
                                            <!-- Strength Slider -->
                                            <!-- Strength Sliders -->
                                            <div class="space-y-2 mt-2">
                                                <div class="flex items-center gap-2 px-1"
                                                    title="Controls visual style/structure influence (Weights)">
                                                    <span
                                                        class="text-xs text-gray-400 w-12 cursor-help border-b border-dotted border-gray-600">Visuals</span>
                                                    <input type="range" x-model.number="model.strength_model" min="0.1"
                                                        max="2.0" step="0.1"
                                                        class="w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-accent">
                                                    <span class="text-xs text-gray-300 w-8 text-right"
                                                        x-text="model.strength_model"></span>
                                                </div>
                                                <div class="flex items-center gap-2 px-1"
                                                    title="Controls prompt understanding influence">
                                                    <span
                                                        class="text-xs text-gray-400 w-12 cursor-help border-b border-dotted border-gray-600">Prompt</span>
                                                    <input type="range" x-model.number="model.strength_clip" min="0.1"
                                                        max="2.0" step="0.1"
                                                        class="w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-accent">
                                                    <span class="text-xs text-gray-300 w-8 text-right"
                                                        x-text="model.strength_clip"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </template>
                                    <div x-show="imageSettings.loras.length === 0"
                                        class="text-center py-2 border border-gray-700/30 border-dashed rounded-lg">
                                        <p class="text-xs text-gray-600">No LoRAs selected</p>
                                    </div>
                                </div>

                                <!-- Upscaling -->
                                <div>
                                    <label class="flex items-center gap-2 cursor-pointer mb-2">
                                        <input type="checkbox" x-model="imageSettings.upscaleEnabled"
                                            class="accent-accent w-4 h-4">
                                        <span class="text-sm font-medium text-gray-300">Upscaling</span>
                                    </label>
                                    <select x-model="imageSettings.upscaleModel"
                                        :disabled="!imageSettings.upscaleEnabled"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-3 py-2 text-white text-sm disabled:opacity-50">
                                        <option value="" x-show="models.enhancement.upscale.length === 0">No models
                                        </option>
                                        <template x-for="m in models.enhancement.upscale" :key="m">
                                            <option :value="m" x-text="m"></option>
                                        </template>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Panel: Output -->
                    <div class="glass rounded-2xl p-6 glass-hover h-full flex flex-col">
                        <label class="block text-sm font-medium text-gray-400 mb-3">Output</label>

                        <!-- Output Display -->
                        <div
                            class="relative min-h-[400px] bg-black/30 rounded-xl overflow-hidden border border-gray-700/50 flex items-center justify-center">
                            <!-- Placeholder -->
                            <div x-show="!currentImage && !isGenerating"
                                class="absolute inset-0 flex items-center justify-center">
                                <div class="text-center text-gray-500">
                                    <svg class="w-16 h-16 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    <p>Your image will appear here</p>
                                </div>
                            </div>

                            <!-- Progress Indicator -->
                            <div x-show="isGenerating"
                                class="absolute inset-0 flex items-center justify-center bg-black/50">
                                <div class="text-center">
                                    <!-- Circular Progress -->
                                    <div class="relative w-24 h-24 mx-auto mb-4">
                                        <svg class="w-24 h-24 transform -rotate-90">
                                            <circle cx="48" cy="48" r="40" stroke="#1a1a1a" stroke-width="8"
                                                fill="none" />
                                            <circle cx="48" cy="48" r="40" stroke="#22c55e" stroke-width="8" fill="none"
                                                stroke-linecap="round" :stroke-dasharray="251.2"
                                                :stroke-dashoffset="251.2 - (251.2 * progress / 100)"
                                                class="transition-all duration-300" />
                                        </svg>
                                        <div class="absolute inset-0 flex items-center justify-center">
                                            <span class="text-xl font-bold text-white"
                                                x-text="Math.round(progress) + '%'"></span>
                                        </div>
                                    </div>
                                    <p class="text-gray-400" x-text="progressText"></p>
                                </div>
                            </div>

                            <!-- Generated Image -->
                            <img x-show="currentImage && !isGenerating" :src="currentImage"
                                @click="openFullscreen(currentImage)"
                                class="max-w-full max-h-[400px] object-contain cursor-pointer transition-transform hover:scale-[1.01]"
                                alt="Generated image" title="Click to view full screen">
                        </div>



                        <!-- Mini Gallery -->
                        <div class="mt-4 pt-4 border-t border-gray-700/50 flex-grow">
                            <div x-show="gallery.length > 0" class="grid grid-cols-3 gap-2">
                                <template x-for="(item, index) in gallery.slice(0, 6)" :key="index">
                                    <div
                                        class="relative group aspect-square rounded-lg overflow-hidden cursor-pointer gallery-item border border-gray-700/50">
                                        <img @click="currentImage = item.url" :src="item.url"
                                            class="w-full h-full object-cover" alt="Gallery image">
                                        <!-- Delete Button (Smaller) -->
                                        <button @click.stop="deleteImage(item.filename)"
                                            class="absolute top-1 right-1 p-1 bg-black/60 hover:bg-red-500/80 text-white rounded opacity-0 group-hover:opacity-100 transition-all duration-200 backdrop-blur-sm">
                                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M6 18L18 6M6 6l12 12" />
                                            </svg>
                                        </button>
                                    </div>
                                </template>
                            </div>
                            <div x-show="gallery.length === 0" class="text-center py-4 text-xs text-gray-600">
                                History empty
                            </div>
                        </div>
                    </div>
                </div>
                </div>

                <div x-show="characterMode" x-transition>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2 glass rounded-2xl p-6 glass-hover">
                            <template x-if="!characterSession">
                                <div>
                                    <h3 class="text-lg font-semibold text-white mb-4">Create Character</h3>
                                    
                                    <div class="mb-4">
                                        <label class="block text-sm text-gray-400 mb-2">Quick Generate from Concept</label>
                                        <div class="flex gap-2">
                                            <input type="text" x-model="characterConcept" placeholder="e.g., cyberpunk hacker girl, mid-20s"
                                                class="flex-1 bg-black/30 border border-gray-700/50 rounded-lg px-4 py-2 text-white placeholder-gray-500 text-sm">
                                            <button @click="generateCharacterFromConcept()" :disabled="isGeneratingSheet || !characterConcept.trim()"
                                                class="px-4 py-2 bg-accent hover:bg-accent-hover disabled:opacity-50 text-black font-medium rounded-lg transition-colors text-sm">
                                                <span x-show="!isGeneratingSheet">Generate</span>
                                                <span x-show="isGeneratingSheet">...</span>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="border-t border-gray-700/50 my-4 pt-4">
                                        <div class="text-xs text-gray-500 uppercase tracking-wide mb-3">Core Identity</div>
                                        <div class="grid grid-cols-2 gap-3 mb-3">
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Name</label>
                                                <input type="text" x-model="characterForm.name" placeholder="Sarah Chen"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-3 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Age</label>
                                                <input type="text" x-model="characterForm.age" placeholder="28"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-3 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-3 gap-3 mb-3">
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Gender</label>
                                                <select x-model="characterForm.gender"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-sm">
                                                    <template x-for="opt in characterOptions.genders"><option :value="opt" x-text="opt"></option></template>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Ethnicity</label>
                                                <input type="text" x-model="characterForm.ethnicity" placeholder="Chinese-American"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Build</label>
                                                <select x-model="characterForm.build"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-sm">
                                                    <template x-for="opt in characterOptions.builds"><option :value="opt" x-text="opt"></option></template>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="border-t border-gray-700/50 my-4 pt-4">
                                        <div class="text-xs text-gray-500 uppercase tracking-wide mb-3">Face & Features</div>
                                        <div class="grid grid-cols-3 gap-3 mb-3">
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Face Shape</label>
                                                <select x-model="characterForm.faceShape"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-sm">
                                                    <template x-for="opt in characterOptions.faceShapes"><option :value="opt" x-text="opt"></option></template>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Skin</label>
                                                <input type="text" x-model="characterForm.skin" placeholder="Fair with freckles"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Expression</label>
                                                <select x-model="characterForm.expression"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-sm">
                                                    <template x-for="opt in characterOptions.expressions"><option :value="opt" x-text="opt"></option></template>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-2 gap-3 mb-3">
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Eye Color</label>
                                                <input type="text" x-model="characterForm.eyeColor" placeholder="Dark brown"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Eye Shape</label>
                                                <input type="text" x-model="characterForm.eyeShape" placeholder="Almond-shaped"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-3 gap-3">
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Eyebrows</label>
                                                <input type="text" x-model="characterForm.eyebrows" placeholder="Thin, arched"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Nose</label>
                                                <input type="text" x-model="characterForm.nose" placeholder="Small, straight"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Lips</label>
                                                <input type="text" x-model="characterForm.lips" placeholder="Full, natural"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="border-t border-gray-700/50 my-4 pt-4">
                                        <div class="text-xs text-gray-500 uppercase tracking-wide mb-3">Hair</div>
                                        <div class="grid grid-cols-2 gap-3 mb-3">
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Color</label>
                                                <input type="text" x-model="characterForm.hairColor" placeholder="Black with highlights"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Length</label>
                                                <select x-model="characterForm.hairLength"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-sm">
                                                    <template x-for="opt in characterOptions.hairLengths"><option :value="opt" x-text="opt"></option></template>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-2 gap-3">
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Style</label>
                                                <input type="text" x-model="characterForm.hairStyle" placeholder="Layered, side-swept"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white placeholder-gray-500 text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-500 mb-1">Texture</label>
                                                <select x-model="characterForm.hairTexture"
                                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-2 text-white text-sm">
                                                    <template x-for="opt in characterOptions.hairTextures"><option :value="opt" x-text="opt"></option></template>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="border-t border-gray-700/50 my-4 pt-4">
                                        <div class="text-xs text-gray-500 uppercase tracking-wide mb-3">Distinguishing Features</div>
                                        <textarea x-model="characterForm.distinguishingFeatures" rows="2"
                                            placeholder="Beauty mark below right eye, silver nose ring, small scar on left eyebrow..."
                                            class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-3 py-2 text-white placeholder-gray-500 resize-none text-sm"></textarea>
                                    </div>
                                    
                                    <div class="border-t border-gray-700/50 my-4 pt-4">
                                        <div class="text-xs text-gray-500 uppercase tracking-wide mb-3">Default Attire</div>
                                        <textarea x-model="characterForm.defaultAttire" rows="2"
                                            placeholder="Black leather jacket, dark jeans, silver jewelry..."
                                            class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-3 py-2 text-white placeholder-gray-500 resize-none text-sm"></textarea>
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4 mb-4">
                                        <div>
                                            <label class="block text-sm text-gray-400 mb-2">Style Preset</label>
                                            <select x-model="characterTemplatePreset"
                                                class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-3 py-2 text-white text-sm">
                                                <template x-for="preset in characterTemplatePresets">
                                                    <option :value="preset" x-text="preset.replace('_', ' ')"></option>
                                                </template>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm text-gray-400 mb-2">Aspect Ratio</label>
                                            <select x-model="imageSettings.aspectRatio"
                                                class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-3 py-2 text-white text-sm">
                                                <option value="1:1">1:1</option>
                                                <option value="3:4">3:4 (Portrait)</option>
                                                <option value="4:3">4:3</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="flex gap-3">
                                        <button @click="createCharacter()" :disabled="isCreatingCharacter || !characterForm.name.trim()"
                                            class="flex-1 bg-accent hover:bg-accent-hover disabled:opacity-50 text-black font-semibold py-3 px-6 rounded-xl transition-all">
                                            <span x-show="!isCreatingCharacter">Create Character</span>
                                            <span x-show="isCreatingCharacter">Creating...</span>
                                        </button>
                                    </div>
                                </div>
                            </template>
                            
                            <template x-if="characterSession">
                                <div>
                                    <div class="flex items-center justify-between mb-4">
                                        <h3 class="text-lg font-semibold text-white" x-text="characterSession.name"></h3>
                                        <button @click="clearCharacterSession()" class="text-gray-400 hover:text-white text-sm">
                                            New Character
                                        </button>
                                    </div>
                                    
                                    <div class="space-y-3 mb-6 max-h-64 overflow-y-auto">
                                        <template x-for="(turn, index) in characterSession.turns" :key="index">
                                            <div class="bg-black/20 rounded-lg p-3">
                                                <div class="text-xs text-gray-500 mb-1" x-text="'Turn ' + (index + 1)"></div>
                                                <div class="text-sm text-gray-300" x-text="turn.user_prompt.substring(0, 150) + (turn.user_prompt.length > 150 ? '...' : '')"></div>
                                            </div>
                                        </template>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-sm text-gray-400 mb-2">Add Modification</label>
                                        <textarea x-model="newTurnPrompt" rows="2"
                                            placeholder="Keep the face, change outfit to a red dress..."
                                            class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-4 py-3 text-white placeholder-gray-500 resize-none text-sm"></textarea>
                                    </div>
                                    
                                    <div class="flex gap-3">
                                        <button @click="addCharacterTurn()" :disabled="!newTurnPrompt.trim()"
                                            class="px-4 py-3 bg-surface-light hover:bg-gray-700 disabled:opacity-50 text-gray-300 font-medium rounded-xl">
                                            Add Turn
                                        </button>
                                        <button @click="generateCharacterImage()" :disabled="isGenerating"
                                            class="flex-1 bg-accent hover:bg-accent-hover disabled:opacity-50 text-black font-semibold py-3 px-6 rounded-xl">
                                            <span x-show="!isGenerating">Generate</span>
                                            <span x-show="isGenerating" class="flex items-center justify-center gap-2">
                                                <svg class="w-5 h-5 animate-spin" fill="none" viewBox="0 0 24 24">
                                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                                </svg>
                                                Generating...
                                            </span>
                                        </button>
                                    </div>
                                    
                                    <div x-show="isGenerating" class="mt-4">
                                        <div class="flex justify-between text-xs text-gray-400 mb-2">
                                            <span x-text="progressText"></span>
                                            <span x-text="Math.round(progress) + '%'"></span>
                                        </div>
                                        <div class="w-full bg-gray-800 rounded-full h-2">
                                            <div class="bg-accent h-2 rounded-full transition-all duration-300" :style="'width: ' + progress + '%'"></div>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                        
                        <div class="glass rounded-2xl p-6 glass-hover">
                            <div x-show="currentImage" class="mb-6">
                                <img :src="currentImage" @click="openFullscreen(currentImage)"
                                    class="w-full rounded-lg cursor-pointer hover:opacity-90 transition-opacity" alt="Generated">
                            </div>
                            <div x-show="!currentImage && !characterSession" class="mb-6">
                                <h4 class="text-sm font-medium text-gray-400 mb-3">Character Sheet Preview</h4>
                                <div class="bg-black/20 rounded-lg p-3 max-h-64 overflow-y-auto">
                                    <pre class="text-xs text-gray-400 whitespace-pre-wrap font-mono" x-text="buildCharacterSheet()"></pre>
                                </div>
                            </div>
                            <div x-show="!currentImage && characterSession" class="aspect-square bg-black/20 rounded-lg flex items-center justify-center mb-6">
                                <span class="text-gray-600 text-sm">Result will appear here</span>
                            </div>
                            
                            <h4 class="text-sm font-medium text-gray-400 mb-3">Previous Sessions</h4>
                            <div class="space-y-2 max-h-48 overflow-y-auto">
                                <template x-for="session in characterSessions" :key="session.id">
                                    <div class="flex items-center justify-between bg-black/20 rounded-lg p-2 hover:bg-black/30 cursor-pointer"
                                        @click="loadCharacterSession(session.id)">
                                        <div>
                                            <div class="text-sm text-white" x-text="session.name"></div>
                                            <div class="text-xs text-gray-500" x-text="session.turns + ' turns'"></div>
                                        </div>
                                        <button @click.stop="deleteCharacterSession(session.id)" class="text-gray-500 hover:text-red-400 p-1">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                            </svg>
                                        </button>
                                    </div>
                                </template>
                                <div x-show="characterSessions.length === 0" class="text-center py-4 text-xs text-gray-600">
                                    No saved sessions
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Video Generation Tab -->
            <div x-show="activeTab === 'video'" x-transition:enter="transition ease-out duration-300"
                x-transition:enter-start="opacity-0 transform translate-y-4"
                x-transition:enter-end="opacity-100 transform translate-y-0" class="lg:-mx-24 xl:-mx-36">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 items-stretch">

                    <!-- Column 1: Prompt & Settings -->
                    <div class="glass rounded-2xl p-6 glass-hover h-full min-h-[575px]">
                        <h3 class="text-sm font-semibold text-white mb-4">Prompt & Settings</h3>

                        <!-- Video Prompt -->
                        <div class="mb-4">
                            <label class="block text-xs text-gray-500 mb-2">Prompt</label>
                            <textarea x-model="videoPrompt" placeholder="Describe the video..." rows="3"
                                class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-500 resize-none"></textarea>
                            <button @click="enhanceVideoPrompt()" :disabled="isEnhancingVideo"
                                class="mt-2 w-full px-4 py-2 bg-surface-light hover:bg-gray-700 disabled:opacity-50 text-gray-300 text-xs font-medium rounded-lg transition-colors duration-200">
                                <span x-show="!isEnhancingVideo">Enhance Prompt</span>
                                <span x-show="isEnhancingVideo" class="flex items-center justify-center gap-2">
                                    <svg class="w-3 h-3 animate-spin" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                            stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor"
                                            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                        </path>
                                    </svg>
                                    Enhancing...
                                </span>
                            </button>
                        </div>

                        <!-- Input Image Upload -->
                        <div class="mb-4">
                            <label class="block text-xs text-gray-500 mb-2">Input Image</label>
                            <div @dragover.prevent="isDragging = true" @dragleave="isDragging = false"
                                @drop.prevent="handleImageDrop($event)"
                                :class="isDragging ? 'border-accent bg-accent/10' : 'border-gray-700/50'"
                                class="border-2 border-dashed rounded-lg p-4 text-center transition-colors cursor-pointer"
                                @click="$refs.imageInput.click()">
                                <input type="file" accept="image/*" x-ref="imageInput"
                                    @change="handleImageSelect($event)" class="hidden">
                                <div x-show="!videoSettings.inputImagePreview">
                                    <svg class="w-8 h-8 mx-auto mb-1 text-gray-500" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                    </svg>
                                    <p class="text-gray-500 text-xs">Drop or click</p>
                                </div>
                                <img x-show="videoSettings.inputImagePreview" :src="videoSettings.inputImagePreview"
                                    class="max-h-24 mx-auto rounded" alt="Input">
                            </div>
                        </div>

                        <!-- Resolution & Seed -->
                        <div class="grid grid-cols-2 gap-3 mb-4">
                            <div>
                                <label class="block text-xs text-gray-500 mb-1">Resolution</label>
                                <select x-model="videoSettings.resolution"
                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-1.5 text-sm text-white">
                                    <option value="480p">480p</option>
                                    <option value="720p">720p</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-xs text-gray-500 mb-1">Seed</label>
                                <input type="number" x-model.number="videoSettings.seed" placeholder="-1"
                                    class="w-full bg-black/30 border border-gray-700/50 rounded-lg px-2 py-1.5 text-sm text-white">
                            </div>
                        </div>

                        <!-- Duration (in seconds) -->
                        <div class="mb-4">
                            <label class="block text-xs text-gray-500 mb-1">
                                Duration: <span class="text-accent" x-text="videoDuration + 's'"></span>
                                <span class="text-gray-600 ml-1"
                                    x-text="'(' + videoSettings.frames + ' frames)'"></span>
                            </label>
                            <input type="range" x-model.number="videoDuration" min="3" max="8" step="1"
                                class="w-full accent-accent">
                        </div>

                        <!-- Generate Button -->
                        <button @click="generateVideo()" :disabled="isGeneratingVideo"
                            class="w-full bg-accent hover:bg-accent-hover disabled:opacity-50 disabled:cursor-not-allowed text-black font-semibold py-2.5 px-4 rounded-xl transition-all duration-200 btn-shimmer">
                            <span x-show="!isGeneratingVideo">Generate Video</span>
                            <span x-show="isGeneratingVideo" class="flex items-center justify-center gap-2">
                                <svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                        stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor"
                                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                    </path>
                                </svg>
                                Generating...
                            </span>
                        </button>
                        <p class="text-xs text-gray-500 mt-2 text-center">Takes 15-20 min</p>
                    </div>

                    <!-- Column 2: Models & LoRAs -->
                    <div class="glass rounded-2xl p-5 glass-hover h-full min-h-[575px]">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="text-sm font-semibold text-white">Models & LoRAs</h3>
                            <button @click="refreshModels()"
                                class="flex items-center gap-1 px-2 py-1 text-xs bg-surface-light hover:bg-gray-700 border border-gray-600 rounded text-gray-300 hover:text-white transition-colors">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                </svg>
                                Refresh
                            </button>
                        </div>

                        <!-- System Models Accordion -->
                        <div class="border border-gray-700/50 rounded-lg mb-3 overflow-hidden">
                            <button @click="videoAccordion.systemModels = !videoAccordion.systemModels"
                                class="w-full flex items-center justify-between px-3 py-2 bg-surface-light/50 hover:bg-surface-light text-left transition-colors">
                                <span class="text-xs font-medium text-gray-300">System Models (4-Step)</span>
                                <svg class="w-4 h-4 text-gray-400 accordion-chevron" :class="{ 'open': videoAccordion.systemModels }"
                                    fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>
                            <div x-show="videoAccordion.systemModels" x-collapse class="px-3 py-2 space-y-2 bg-black/20">
                                <div>
                                    <label class="block text-xs text-gray-500 mb-1">High Noise Model</label>
                                    <select x-model="videoSettings.modelHigh"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded px-2 py-1 text-xs text-white">
                                        <template x-for="m in models.video.high" :key="m">
                                            <option :value="m" x-text="m.split('/').pop()"></option>
                                        </template>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500 mb-1">Low Noise Model</label>
                                    <select x-model="videoSettings.modelLow"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded px-2 py-1 text-xs text-white">
                                        <template x-for="m in models.video.low" :key="m">
                                            <option :value="m" x-text="m.split('/').pop()"></option>
                                        </template>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500 mb-1">High Noise LoRA (Lightning)</label>
                                    <select x-model="videoSettings.loraHigh"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded px-2 py-1 text-xs text-white">
                                        <template x-for="l in models.video.loras_high" :key="l">
                                            <option :value="l" x-text="l.split('/').pop()"></option>
                                        </template>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-500 mb-1">Low Noise LoRA (Lightning)</label>
                                    <select x-model="videoSettings.loraLow"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded px-2 py-1 text-xs text-white">
                                        <template x-for="l in models.video.loras_low" :key="l">
                                            <option :value="l" x-text="l.split('/').pop()"></option>
                                        </template>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Style LoRAs Section -->
                        <div class="mb-3 pt-3 border-t border-gray-700/50">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-xs font-medium text-gray-400">Style LoRAs (High Noise)</span>
                                <button @click="addVideoLoraHigh()" class="text-xs text-accent hover:text-accent-hover font-medium">+ Add</button>
                            </div>
                            <div class="space-y-2">
                                <template x-for="(lora, index) in videoSettings.lorasHighUser" :key="index">
                                    <div class="flex items-center gap-2 bg-white/5 p-2 rounded border border-gray-700/30 overflow-hidden">
                                        <select x-model="lora.name" class="flex-1 min-w-0 bg-black/30 border border-gray-700/50 rounded px-2 py-1 text-xs text-white truncate">
                                            <option value="">Select...</option>
                                            <template x-for="l in models.video.style_loras" :key="l">
                                                <option :value="l" x-text="l.split('/').pop()"></option>
                                            </template>
                                        </select>
                                        <input type="range" x-model.number="lora.strength_model" min="0.1" max="2.0" step="0.1" class="w-16 h-1 accent-accent">
                                        <span class="text-xs text-gray-300 w-6" x-text="lora.strength_model"></span>
                                        <button @click="removeVideoLoraHigh(index)" class="text-gray-500 hover:text-red-400">
                                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                            </svg>
                                        </button>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="mb-3">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-xs font-medium text-gray-400">Style LoRAs (Low Noise)</span>
                                <button @click="addVideoLoraLow()" class="text-xs text-accent hover:text-accent-hover font-medium">+ Add</button>
                            </div>
                            <div class="space-y-2">
                                <template x-for="(lora, index) in videoSettings.lorasLowUser" :key="index">
                                    <div class="flex items-center gap-2 bg-white/5 p-2 rounded border border-gray-700/30 overflow-hidden">
                                        <select x-model="lora.name" class="flex-1 min-w-0 bg-black/30 border border-gray-700/50 rounded px-2 py-1 text-xs text-white truncate">
                                            <option value="">Select...</option>
                                            <template x-for="l in models.video.style_loras" :key="l">
                                                <option :value="l" x-text="l.split('/').pop()"></option>
                                            </template>
                                        </select>
                                        <input type="range" x-model.number="lora.strength_model" min="0.1" max="2.0" step="0.1" class="w-16 h-1 accent-accent">
                                        <span class="text-xs text-gray-300 w-6" x-text="lora.strength_model"></span>
                                        <button @click="removeVideoLoraLow(index)" class="text-gray-500 hover:text-red-400">
                                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                            </svg>
                                        </button>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Enhancement Section -->
                        <div class="pt-3 border-t border-gray-700/50">
                            <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Enhancement</h4>
                            <div class="space-y-2">
                                <div>
                                    <label class="flex items-center gap-2 cursor-pointer mb-1">
                                        <input type="checkbox" x-model="videoSettings.upscaleEnabled"
                                            class="accent-accent w-3 h-3">
                                        <span class="text-xs text-gray-300">Upscaling</span>
                                    </label>
                                    <select x-model="videoSettings.upscaleModel" :disabled="!videoSettings.upscaleEnabled"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded px-2 py-1 text-xs text-white disabled:opacity-50">
                                        <option value="" x-show="models.enhancement.upscale.length === 0">No models</option>
                                        <template x-for="m in models.enhancement.upscale" :key="m">
                                            <option :value="m" x-text="m"></option>
                                        </template>
                                    </select>
                                </div>
                                <div>
                                    <label class="flex items-center gap-2 cursor-pointer mb-1">
                                        <input type="checkbox" x-model="videoSettings.interpolateEnabled"
                                            class="accent-accent w-3 h-3">
                                        <span class="text-xs text-gray-300">RIFE Interpolation</span>
                                    </label>
                                    <select x-model="videoSettings.interpolateModel"
                                        :disabled="!videoSettings.interpolateEnabled"
                                        class="w-full bg-black/30 border border-gray-700/50 rounded px-2 py-1 text-xs text-white disabled:opacity-50">
                                        <option value="" x-show="models.enhancement.vfi.length === 0">No models</option>
                                        <template x-for="m in models.enhancement.vfi" :key="m">
                                            <option :value="m" x-text="m"></option>
                                        </template>
                                    </select>
                                    <div x-show="videoSettings.interpolateEnabled" class="mt-1">
                                        <div class="flex items-center gap-2">
                                            <span class="text-xs text-gray-500">Mult:</span>
                                            <input type="range" x-model.number="videoSettings.interpolateMultiplier" min="2"
                                                max="4" step="1" class="flex-1 accent-accent h-1">
                                            <span class="text-xs text-accent" x-text="videoSettings.interpolateMultiplier + 'x'"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Column 3: Output & Status -->
                    <div class="glass rounded-2xl p-6 glass-hover h-full min-h-[575px]">
                        <h3 class="text-sm font-semibold text-white mb-4">Output</h3>

                        <div
                            class="relative aspect-video bg-black/30 rounded-xl overflow-hidden border border-gray-700/50 mb-4">
                            <!-- Placeholder -->
                            <div x-show="!currentVideo && !isGeneratingVideo"
                                class="absolute inset-0 flex items-center justify-center">
                                <div class="text-center text-gray-500">
                                    <svg class="w-12 h-12 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                    </svg>
                                    <p class="text-xs">Video output</p>
                                </div>
                            </div>

                            <!-- Progress -->
                            <div x-show="isGeneratingVideo"
                                class="absolute inset-0 flex items-center justify-center bg-black/50">
                                <div class="text-center">
                                    <div class="mb-4">
                                        <svg class="w-16 h-16 mx-auto text-accent animate-spin" fill="none"
                                            viewBox="0 0 24 24">
                                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                                stroke-width="4"></circle>
                                            <path class="opacity-75" fill="currentColor"
                                                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                            </path>
                                        </svg>
                                    </div>
                                    <p class="text-gray-200 font-medium" x-text="videoProgressText"></p>
                                </div>
                            </div>

                            <!-- Video Player -->
                            <video x-show="currentVideo && !isGeneratingVideo" :src="currentVideo" controls loop
                                class="w-full h-full"></video>
                        </div>

                        <!-- Usage Guide -->
                        <div class="mt-4 p-4 rounded-xl bg-surface-light border border-gray-700/50">
                            <h4 class="text-xs font-semibold text-gray-400 mb-2 uppercase tracking-wider">Usage Tips
                            </h4>
                            <ul class="space-y-2 text-xs text-gray-400">
                                <li class="flex gap-2">
                                    <span class="text-accent"></span>
                                    <span><strong>12GB VRAM (3060):</strong> 480p ~6m, 720p ~25m. Max <strong>x2
                                            Upscale</strong>.</span>
                                </li>
                                <li class="flex gap-2">
                                    <span class="text-accent"></span>
                                    <span><strong>24GB+ VRAM (4090):</strong> 720p ~5-6m. Can handle x4 Upscale.</span>
                                </li>
                                <li class="flex gap-2">
                                    <span class="text-accent"></span>
                                    <span><strong>Interpolation:</strong> Now happens <em>before</em> upscale for
                                        efficiency.</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                </div>
            </div>
        </main>

        <!-- Toast Notifications -->
        <div class="fixed bottom-4 right-4 z-50 space-y-2">
            <template x-for="toast in toasts" :key="toast.id">
                <div x-show="toast.visible" x-transition:enter="toast-enter" x-transition:leave="toast-leave"
                    :class="toast.type === 'error' ? 'bg-red-900/90' : 'bg-accent/90'"
                    class="px-4 py-3 rounded-lg text-white shadow-lg backdrop-blur">
                    <p x-text="toast.message"></p>
                </div>
            </template>
        </div>
    </div>

    <!-- Full Screen Modal -->
    <div x-show="showFullscreen" x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
        x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0"
        class="fixed inset-0 z-[100] bg-black/95 flex items-center justify-center p-4 backdrop-blur-sm"
        @click="showFullscreen = false">

        <!-- Close Button -->
        <button @click="showFullscreen = false"
            class="absolute top-4 right-4 p-2 text-white/70 hover:text-white bg-black/50 rounded-full hover:bg-white/10 transition-colors">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>

        <img :src="fullscreenImage" @click.stop class="max-w-full max-h-full object-contain shadow-2xl rounded-lg"
            alt="Full screen view">
    </div>

    <script src="/static/app.js"></script>
</body>

</html>